/*! kirjasto2030 - v0.0.0 - 2015-05-06
* Copyright (c) 2015 ;*/
var app=$.sammy(function(){var a="partials/",b="stories/",c="page-";$("body").removeClass("loading");var d={intro:[!1,["#/teknologia","Teknologia"]],teknologia:[["#/intro","Intro"],["#/laki","Laki"]],"teknologia-tarinat":[["#/teknologia","Teknologia"],["#/laki","Laki"]]},e=function(b,d){console.log("loadContent",b,"function"==typeof d);var e=(new Date).getTime();$("body").addClass("loading"),$("main").addClass("transition"),setTimeout(function(){$("main").load(a+b+".html",function(){var a=(new Date).getTime()-e-200;a=a>200?0:a,setTimeout(function(){$("body").removeClass("loading"),$("main").removeAttr("class").addClass(c+b),$("#pages a.current").removeClass("current"),$("#pages a[href$='"+b+"'").addClass("current"),"function"==typeof d&&d()},a)})},200),$(document).scrollTop(0)},f=function(a){console.log("loadStory?",a),$("main nav").find("a[href$='"+a+"']").addClass("active"),$("#story").load(b+a+".html",function(){})},g=function(a,b){console.log(a,b);try{if(a===!1)throw new Error("No button location and label provided, hide button");$(".button-left-bottom").attr("href",a[0]).fadeIn().find("span").html(a[1])}catch(c){$(".button-left-bottom").fadeOut()}try{if(b===!1)throw new Error("No button location and label provided, hide button");$(".button-right-bottom").attr("href",b[0]).fadeIn().find("span").html(b[1])}catch(c){$(".button-right-bottom").fadeOut()}},h=function(){var a=this.params.page,b=this.params.story;console.log(a,b),d.hasOwnProperty(a)?("undefined"!==b?e(a,function(){console.log("hello callback"),f(b)}):e(a),g(d[a][0],d[a][1])):this.redirect("#/intro")};this.get("#/:page",h),this.get("#/:page/:story",h),this.get("#/liitteet",function(){e("liitteet"),g(["#/teknologia","Teknologia"],["#/laki","Laki"])}),this.get("",function(){this.redirect("#/intro")})});$(function(){app.run()}),$(function(){function a(){c.toggleClass("open")}function b(){c.removeClass("open")}var c=$("#page-navigation"),d=c.find("#pages"),e=$(".button-menu");e.on("click",a),d.on("click","a",b),$(".button-left-bottom, .button-right-bottom").on("click",b)}),$(function(){$(document).on("scroll",function(){if($("main").hasClass("page-intro")&&$("body").width()>$("#width-30em").width()){var a=$("body").scrollTop()/($("main").height()-$("body").height());console.log(a),$("#intro").css("margin-left",-100*a+"%"),$("#timeline").css("margin-left",-75*a+"%"),$("#timeline-line").css("margin-left",20*(1-a)+"%"),a>.5?$(".timeline-event").addClass("visible"):$(".timeline-event").removeClass("visible")}})});